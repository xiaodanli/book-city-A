require(["jquery","render","text!bookSearchTpl","lazy","storage"],function(o,e,t,a,n){o("body").append(t);var i=n.get("history")||[];function s(t){o(".history-title").show();var n=[];t.forEach(function(t,a){var o={};o.ad_name=t,n.push(o)}),e("#tag-tpl",".history",n,!0)}0<i.length&&s(i),o(".icon-back").on("click",function(){location.href="/"}),o.ajax({url:"/api/hot",dataType:"json",success:function(t){console.log(t),e("#tag-tpl",".hot",t.ads)},error:function(t){console.warn(t)}});var r=o(".ipt"),c=(o(".type-tags"),o(".search-list")),l=o(".tag-wrap");function h(t){-1==i.indexOf(t)&&(i.unshift(t),n.set("history",i)),s(i),o.ajax({url:"/api/search",data:{key:t},dataType:"json",success:function(t){var a;console.log(t),(a=t)?(e("#search-template",".search-list",a.items,!0),o(".search-list img").lazyload({threshold:200,container:o(".search-list")})):c.html("<p>暂无数据</p>")},error:function(t){console.warn(t)}})}o(".search-btn").on("click",function(){c.html(" "),l.hide(),c.show();var t=r.val();t?h(t):c.html("<p>搜索内容为空，请输入搜索内容</p>")}),r.on("input",function(){r.val()||(l.show(),c.hide())}),o(".type-tags").on("click","li",function(){c.html(" "),l.hide(),c.show();var t=o(this).html();r.val(t),h(t)})});